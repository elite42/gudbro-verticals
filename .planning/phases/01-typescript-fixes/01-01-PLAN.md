---
phase: 01-typescript-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - shared/database/cuisines/americas/argentinian/data/beverages.ts
  - shared/database/sides/appetizers/data/international-appetizers.ts
  - apps/wellness/frontend/app/gym/[slug]/page.tsx
  - apps/accommodations/frontend/app/stay/[code]/page.tsx
autonomous: true

must_haves:
  truths:
    - 'pnpm typecheck runs with zero errors across all workspaces'
    - 'Wellness gym detail page renders pass prices without type errors'
    - 'Accommodations stay page renders deal tags without type errors'
    - 'Shared database files parse without syntax errors'
  artifacts:
    - path: 'shared/database/cuisines/americas/argentinian/data/beverages.ts'
      provides: 'Argentinian beverages data'
      contains: 'Fernet Branca mixed with cola'
    - path: 'shared/database/sides/appetizers/data/international-appetizers.ts'
      provides: 'International appetizers data'
      contains: 'ING_DAIRY_YOGURT_STRAINED'
    - path: 'apps/wellness/frontend/app/gym/[slug]/page.tsx'
      provides: 'Gym detail page with typed pass prices'
      contains: 'formatPrice'
    - path: 'apps/accommodations/frontend/app/stay/[code]/page.tsx'
      provides: 'Stay detail page with typed deal tags'
      contains: 'deal.tag'
  key_links:
    - from: 'shared/database/cuisines/americas/argentinian/data/beverages.ts'
      to: 'TypeScript compiler'
      via: 'valid string literal syntax'
      pattern: 'description: ["''].*["'']'
    - from: 'shared/database/sides/appetizers/data/international-appetizers.ts'
      to: 'TypeScript compiler'
      via: 'valid array syntax'
      pattern: "ingredient_ids: \\["
---

<objective>
Fix all TypeScript compilation errors across vertical PWAs and shared database code.

Purpose: Unblock builds for all verticals. Zero TS errors is the foundation for Phase 2 (UI/UX) and Phase 3 (Verification).
Output: All 4 files fixed, `pnpm typecheck` passes clean.
</objective>

<execution_context>
@/Users/gianfrancodagostino/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gianfrancodagostino/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-typescript-fixes/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix shared database syntax errors</name>
  <files>
    shared/database/cuisines/americas/argentinian/data/beverages.ts
    shared/database/sides/appetizers/data/international-appetizers.ts
  </files>
  <action>
    **File 1: beverages.ts (line 47)**
    The description string has a double single-quote (`Argentina''s`) which is invalid JS/TS.
    Change line 47 from:
    `description: 'Fernet Branca mixed with cola, Argentina''s signature cocktail',`
    to:
    `description: "Fernet Branca mixed with cola, Argentina's signature cocktail",`

    **File 2: international-appetizers.ts (line 430)**
    The ingredient_ids array is corrupted with broken string literals.
    Current (broken): `ingredient_ids: ['ING_DAIRY_YOGURT_STRAINED'ING_OTHER___'ING_OIL_OLIVE', 'ING_OTHER_ZA_'atar', 'mint'],`
    This is a labneh/yogurt dip recipe (thick strained yogurt with olive oil, za'atar and mint).
    Replace line 430 with:
    `ingredient_ids: ['ING_DAIRY_YOGURT_STRAINED', 'ING_OIL_OLIVE', 'ING_SPICE_ZAATAR', 'ING_HERB_MINT'],`

    Use consistent ingredient ID naming convention (check nearby entries in the file for the correct pattern, e.g. ING_SPICE_ZAATAR vs ING_OTHER_ZAATAR). If no ZAATAR ID exists in the codebase, use `ING_SPICE_ZAATAR`. For mint, use `ING_HERB_MINT`.

  </action>
  <verify>
    Run: `npx tsc --noEmit --project apps/tours/frontend/tsconfig.json 2>&1 | head -20` (tours imports shared DB).
    If no tsconfig in tours, run: `npx tsc --noEmit shared/database/cuisines/americas/argentinian/data/beverages.ts shared/database/sides/appetizers/data/international-appetizers.ts 2>&1` or simply verify files parse with `node -e "require('./shared/database/cuisines/americas/argentinian/data/beverages.ts')"` — but since these are .ts files, just confirm no red squiggles remain by re-reading the fixed lines.
  </verify>
  <done>Both shared database files have valid TypeScript syntax with no string or array errors.</done>
</task>

<task type="auto">
  <name>Task 2: Fix TypeScript type errors in wellness and accommodations</name>
  <files>
    apps/wellness/frontend/app/gym/[slug]/page.tsx
    apps/accommodations/frontend/app/stay/[code]/page.tsx
  </files>
  <action>
    **File 1: wellness gym/[slug]/page.tsx (line 622)**
    The `passOptions` array is defined on line 504 with `price: number | undefined`, then filtered on line 508 with `.filter(p => p.price !== undefined)` and cast with `as { ... price: number }[]`.

    However TypeScript still sees `price` as `number | undefined` on line 622 when calling `formatPrice(pass.price)`.

    The issue is likely that the type assertion on line 508 is not sticking or the variable is being re-inferred. Fix by ensuring the cast is correct. Check line 508 — if it already has `as { key: 'day' | 'week' | 'month'; label: string; subtitle: string; price: number }[]`, the cast should work.

    If the error persists, change the approach: use a proper type guard by replacing the filter+cast chain with:
    ```typescript
    const passOptions = [
      { key: 'day' as const, label: 'Day Pass', subtitle: 'Full day access', price: gym.dayPass },
      { key: 'week' as const, label: 'Week Pass', subtitle: '7 days unlimited', price: gym.weekPass },
      { key: 'month' as const, label: 'Month Pass', subtitle: '30 days unlimited', price: gym.monthPass },
    ].filter((p): p is { key: 'day' | 'week' | 'month'; label: string; subtitle: string; price: number } => p.price !== undefined);
    ```
    This uses a type predicate which TypeScript trusts for narrowing. Remove the trailing `as` cast if using the type predicate approach.

    **File 2: accommodations stay/[code]/page.tsx (lines 1102-1104)**
    The `deal` variable comes from `currentDeals.map()` where `currentDeals = localDeals[dealTab]`. The `localDeals` object has different shapes per tab (tours items have no `tag`, food items have no `tag`, etc.). The `'tag' in deal && deal.tag` check narrows at runtime but TypeScript sees `deal.tag` as `unknown` in the union.

    Fix line 1104 by casting the rendered value:
    Change `{deal.tag}` to `{deal.tag as string}` or `{String(deal.tag)}`.

    Preferred: `{String(deal.tag)}` — avoids type assertion, handles edge cases.

  </action>
  <verify>
    Run `pnpm typecheck` from repo root. Expected: zero TypeScript errors.
    If pnpm typecheck is not available as a root script, run typecheck per workspace:
    - `cd apps/wellness/frontend && npx tsc --noEmit`
    - `cd apps/accommodations/frontend && npx tsc --noEmit`
    All must exit with code 0.
  </verify>
  <done>
    - `pnpm typecheck` (or per-workspace tsc --noEmit) passes with zero errors
    - wellness gym page: `formatPrice(pass.price)` compiles without error
    - accommodations stay page: `deal.tag` renders without type error
  </done>
</task>

</tasks>

<verification>
Run full typecheck from repo root:
```bash
pnpm typecheck
```
Expected: zero errors across all workspaces.

If `pnpm typecheck` doesn't exist, run individually for affected workspaces:

```bash
cd apps/wellness/frontend && npx tsc --noEmit
cd apps/accommodations/frontend && npx tsc --noEmit
```

Also verify shared database files compile (they're imported by other verticals like tours).
</verification>

<success_criteria>

1. `pnpm typecheck` exits with code 0 (zero errors)
2. No regressions — only the 4 targeted lines/sections changed
3. Shared database data integrity preserved (correct ingredient IDs, correct description text)
4. Requirements covered: TS-01, TS-02, TS-03, TS-04, TS-05
   </success_criteria>

<output>
After completion, create `.planning/phases/01-typescript-fixes/01-01-SUMMARY.md`
</output>
