---
phase: 41-shared-foundation
plan: 06
type: execute
wave: 3
depends_on: ['41-02', '41-04', '41-05']
files_modified:
  - apps/coffeeshop/frontend/tsconfig.json
  - apps/coffeeshop/frontend/tailwind.config.js
  - apps/coffeeshop/frontend/next.config.js
  - apps/gym/frontend/tsconfig.json
  - apps/gym/frontend/tailwind.config.js
  - apps/gym/frontend/next.config.js
  - apps/laundry/frontend/tsconfig.json
  - apps/laundry/frontend/tailwind.config.js
  - apps/laundry/frontend/next.config.js
  - apps/pharmacy/frontend/tsconfig.json
  - apps/pharmacy/frontend/tailwind.config.js
  - apps/pharmacy/frontend/next.config.js
  - apps/workshops/frontend/tsconfig.json
  - apps/workshops/frontend/tailwind.config.js
  - apps/workshops/frontend/next.config.js
autonomous: true

must_haves:
  truths:
    - 'All 5 PWAs (coffeeshop, gym, laundry, pharmacy, workshops) extend shared/config/tsconfig.app.json'
    - 'All 5 PWAs use shared Tailwind preset via presets array'
    - 'All 5 PWAs use createNextConfig factory for next.config'
    - 'All 5 PWAs still build successfully after config migration'
  artifacts:
    - path: 'apps/gym/frontend/tsconfig.json'
      provides: 'Extends shared tsconfig'
      contains: 'tsconfig.app.json'
    - path: 'apps/gym/frontend/next.config.js'
      provides: 'Uses shared Next.js config factory'
      contains: 'createNextConfig'
  key_links:
    - from: 'apps/gym/frontend/tsconfig.json'
      to: 'shared/config/tsconfig.app.json'
      via: 'extends'
      pattern: 'tsconfig.app.json'
    - from: 'apps/gym/frontend/next.config.js'
      to: 'shared/config/next.config.base.js'
      via: 'require'
      pattern: 'createNextConfig'
    - from: 'apps/gym/frontend/tailwind.config.js'
      to: 'shared/config/tailwind.preset.js'
      via: 'presets'
      pattern: 'tailwind.preset'
---

<objective>
Migrate all 5 PWA frontend config files (tsconfig, tailwind, next.config) to use the shared base configs created in Plan 41-02.

Purpose: Currently each app has duplicated config settings. Plan 41-02 created shared/config/tsconfig.app.json, tailwind.preset.js, and next.config.base.js. This plan replaces the duplicated configs with minimal per-app configs that extend/use the shared ones. This covers the 5 core PWAs (coffeeshop, gym, laundry, pharmacy, workshops) -- 15 config files total.

Output: 15 config files simplified to extend shared configs. All apps retain per-app overrides (port, colors, content paths).
</objective>

<execution_context>
@/Users/gianfrancodagostino/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gianfrancodagostino/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-shared-foundation/41-RESEARCH.md
@.planning/phases/41-shared-foundation/41-02-SUMMARY.md

# Shared configs (created by Plan 02):

@shared/config/tsconfig.app.json
@shared/config/tailwind.preset.js
@shared/config/next.config.base.js

# Reference: current per-app configs (read to understand per-app overrides needed):

@apps/coffeeshop/frontend/tsconfig.json
@apps/coffeeshop/frontend/tailwind.config.js
@apps/coffeeshop/frontend/next.config.js
@apps/gym/frontend/tsconfig.json
@apps/gym/frontend/tailwind.config.js
@apps/gym/frontend/next.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate tsconfig.json and next.config.js for all 5 PWAs</name>
  <files>
    apps/coffeeshop/frontend/tsconfig.json
    apps/coffeeshop/frontend/next.config.js
    apps/gym/frontend/tsconfig.json
    apps/gym/frontend/next.config.js
    apps/laundry/frontend/tsconfig.json
    apps/laundry/frontend/next.config.js
    apps/pharmacy/frontend/tsconfig.json
    apps/pharmacy/frontend/next.config.js
    apps/workshops/frontend/tsconfig.json
    apps/workshops/frontend/next.config.js
  </files>
  <action>
    **tsconfig.json migration for each app:**
    Replace the per-app tsconfig with a minimal one that extends the shared base:
    ```json
    {
      "extends": "../../../shared/config/tsconfig.app.json",
      "compilerOptions": {
        "paths": {
          "@/*": ["./*"]
        }
      },
      "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
      "exclude": ["node_modules"]
    }
    ```
    Note: The shared base already includes @gudbro/* path aliases. Per-app only needs `@/*` for its local imports. If an app has any UNIQUE compilerOptions not in the shared base, keep those as local overrides.

    For coffeeshop: It already extends tsconfig.base.json -- update to extend the new shared config instead. Preserve any coffeeshop-specific paths or settings.

    **next.config.js migration for each app:**
    Replace with the factory pattern:
    ```javascript
    const { createNextConfig } = require('../../../shared/config/next.config.base');
    module.exports = createNextConfig({ port: XXXX });
    ```
    Port numbers per app (read from current next.config.js):
    - coffeeshop: 3004
    - gym: 3033
    - laundry: 3030
    - pharmacy: 3031
    - workshops: 3032

    If an app has additionalDomains not in the shared base, pass them via the `additionalDomains` parameter. If an app has unique overrides (e.g., custom webpack config, rewrites), pass via `overrides` parameter.

    Read each current next.config.js CAREFULLY to identify any app-specific settings before replacing.

  </action>
  <verify>
    Run `pnpm --filter coffeeshop build && pnpm --filter gym build && pnpm --filter laundry build && pnpm --filter pharmacy build && pnpm --filter workshops build` -- all must succeed.
    Verify tsconfig extends shared: `grep "tsconfig.app.json" apps/*/frontend/tsconfig.json` -- should show all 5.
    Verify next.config uses factory: `grep "createNextConfig" apps/*/frontend/next.config.js` -- should show all 5.
  </verify>
  <done>
    All 5 PWAs extend shared/config/tsconfig.app.json and use createNextConfig factory. All apps build successfully with their correct port numbers and any app-specific overrides preserved.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate tailwind.config for all 5 PWAs</name>
  <files>
    apps/coffeeshop/frontend/tailwind.config.js
    apps/gym/frontend/tailwind.config.js
    apps/laundry/frontend/tailwind.config.js
    apps/pharmacy/frontend/tailwind.config.js
    apps/workshops/frontend/tailwind.config.js
  </files>
  <action>
    **tailwind.config migration for each app:**
    Update to use the shared preset while keeping app-specific content paths and overrides:
    ```javascript
    const sharedPreset = require('../../../shared/config/tailwind.preset');

    /** @type {import('tailwindcss').Config} */
    module.exports = {
      presets: [sharedPreset],
      content: [
        './app/**/*.{ts,tsx}',
        './components/**/*.{ts,tsx}',
        './lib/**/*.{ts,tsx}',
        '../../../shared/ui/**/*.{ts,tsx}',  // Include shared UI components
      ],
      theme: {
        extend: {
          // App-specific theme overrides ONLY (remove anything now in the preset)
        },
      },
      plugins: [], // Keep any app-specific plugins
    };
    ```

    For each app:
    1. Read current tailwind.config to identify what is app-specific vs what is in the shared preset
    2. Remove any colors/animations/keyframes that are now in the shared preset
    3. Keep any genuinely app-specific theme overrides
    4. Keep the app's content paths (these are app-specific)
    5. Add `'../../../shared/ui/**/*.{ts,tsx}'` to content paths so shared UI component styles are included

    NOTE: Some apps use `tailwind.config.ts` (TypeScript). Convert to `.js` (CommonJS) for consistency with the require() pattern, OR use dynamic import. Check which format each app currently uses and handle accordingly. If converting from .ts to .js, delete the old .ts file.

    IMPORTANT: coffeeshop has the most extensive tailwind config. Much of it was used as the basis for the shared preset. Remove duplicated tokens but keep anything coffeeshop-specific (e.g., gradient definitions, app-specific component variants).

  </action>
  <verify>
    Run `pnpm --filter coffeeshop build && pnpm --filter gym build && pnpm --filter laundry build && pnpm --filter pharmacy build && pnpm --filter workshops build` -- all must succeed.
    Verify preset usage: `grep "tailwind.preset" apps/*/frontend/tailwind.config.*` -- should show all 5.
    Verify shared UI content path: `grep "shared/ui" apps/*/frontend/tailwind.config.*` -- should show all 5.
  </verify>
  <done>
    All 5 PWAs use the shared Tailwind preset. Duplicated theme tokens removed. App-specific overrides preserved. Shared UI content paths added. All apps build successfully with correct styling.
  </done>
</task>

</tasks>

<verification>
1. `pnpm build` for all 5 PWAs succeeds
2. All 5 tsconfig.json files extend shared/config/tsconfig.app.json
3. All 5 next.config.js files use createNextConfig factory
4. All 5 tailwind configs use shared preset
5. No style regressions -- shared UI classes are included in content paths
6. Each app retains its per-app config (port, content paths, app-specific overrides)
</verification>

<success_criteria>

- 15 config files (5 apps x 3 configs each) simplified to use shared bases
- All 5 PWAs build successfully
- tsconfig: all extend shared base with @gudbro/\* aliases
- tailwind: all use preset, duplicated tokens removed, shared UI content path added
- next.config: all use factory with correct port number
- No behavioral or styling regressions
  </success_criteria>

<output>
After completion, create `.planning/phases/41-shared-foundation/41-06-SUMMARY.md`
</output>
