---
phase: 03-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/pharmacy/frontend/**
  - apps/workshops/frontend/**
  - apps/laundry/frontend/**
  - apps/wellness/frontend/**
  - apps/gym/frontend/**
  - apps/tours/frontend/**
  - apps/accommodations/frontend/**
autonomous: true

must_haves:
  truths:
    - 'All 7 vertical PWAs complete next build with exit code 0'
    - 'No TypeScript errors remain in any vertical build output'
    - 'Any inline fix is less than 5 lines and directly addresses a build error'
  artifacts:
    - path: '.planning/phases/03-verification/build-results.md'
      provides: 'Build pass/fail status for all 7 verticals'
      contains: 'PASS'
  key_links:
    - from: 'pnpm --filter @gudbro/*-frontend build'
      to: 'exit code 0'
      via: 'next build pipeline'
      pattern: 'exit code: 0'
---

<objective>
Build all 7 vertical PWAs and fix any build errors inline.

Purpose: Verify that every vertical compiles successfully after Phase 1 (TypeScript fixes) and Phase 2 (UI/UX harmony). Fix simple errors inline to achieve zero build errors.
Output: All 7 verticals build without errors. A build-results.md file records pass/fail per vertical.
</objective>

<execution_context>
@/Users/gianfrancodagostino/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gianfrancodagostino/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-verification/03-RESEARCH.md
@.planning/phases/03-verification/03-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build Category A verticals (Pharmacy, Workshops, Laundry, Wellness, Gym)</name>
  <files>
    apps/pharmacy/frontend/**
    apps/workshops/frontend/**
    apps/laundry/frontend/**
    apps/wellness/frontend/**
    apps/gym/frontend/**
  </files>
  <action>
First, run `pnpm install` at the monorepo root to ensure all workspace dependencies are resolved.

Then build each Category A vertical sequentially using pnpm filter from the monorepo root. Capture exit code and key output for each.

Build order (simplest first):

1. `pnpm --filter @gudbro/pharmacy-frontend build`
2. `pnpm --filter @gudbro/workshops-frontend build`
3. `pnpm --filter @gudbro/laundry-frontend build`
4. `pnpm --filter @gudbro/wellness-frontend build`
5. `pnpm --filter @gudbro/gym-frontend build`

For each build:

- If exit code is 0: record as PASS, note any warnings (do NOT fix warnings)
- If exit code is non-zero: read the error output, identify the root cause
  - If fix is simple (< 5 lines, clear cause): fix inline, re-run build, commit fix atomically
  - If fix is complex: record as FAIL with details, do not attempt fix

IMPORTANT:

- Always use `pnpm --filter <package-name> build` from monorepo root — never cd into the app dir
- Do NOT fix deprecation warnings (e.g., `images.domains` deprecated) — log only
- Do NOT fix unused variable warnings — log only
- All 5 verticals depend on @gudbro/menu-template; pnpm filter handles this dependency chain automatically
  </action>
  <verify>
  All 5 Category A verticals produce exit code 0 from `pnpm --filter <name> build`.
  </verify>
  <done>Pharmacy, Workshops, Laundry, Wellness, and Gym all build successfully with zero errors.</done>
  </task>

<task type="auto">
  <name>Task 2: Build Category B verticals (Tours, Accommodations) and produce build report</name>
  <files>
    apps/tours/frontend/**
    apps/accommodations/frontend/**
    .planning/phases/03-verification/build-results.md
  </files>
  <action>
Build the two standalone verticals sequentially:

1. `pnpm --filter @gudbro/tours-frontend build`
   - Tours has `transpilePackages: ['@shared/payment']` and webpack alias for `@shared`
   - If build fails on @shared/payment: check that shared/payment/ exists and exports are correct. Fix if simple.
   - Tours has known soups database type errors (from STATE.md — "outside scope"). If these cause build failure, suppress with `// @ts-ignore` or `@ts-expect-error` only if absolutely needed for build to pass.

2. `pnpm --filter @gudbro/accommodations-frontend build`
   - Uses ESM next.config.js (`export default` instead of `module.exports`)
   - If ESM config causes issues: either add `"type": "module"` to package.json or convert to CJS
   - Has `images: { unoptimized: true }` which is intentional

For each build, apply same rules as Task 1 (fix simple errors inline, log complex ones).

After all 7 builds complete (including Task 1 results), create `.planning/phases/03-verification/build-results.md` with:

```markdown
# Build Verification Results

| Vertical       | Package                         | Build Status | Errors Fixed | Warnings |
| -------------- | ------------------------------- | ------------ | ------------ | -------- |
| Pharmacy       | @gudbro/pharmacy-frontend       | PASS/FAIL    | N            | ...      |
| Workshops      | @gudbro/workshops-frontend      | PASS/FAIL    | N            | ...      |
| Laundry        | @gudbro/laundry-frontend        | PASS/FAIL    | N            | ...      |
| Wellness       | @gudbro/wellness-frontend       | PASS/FAIL    | N            | ...      |
| Gym            | @gudbro/gym-frontend            | PASS/FAIL    | N            | ...      |
| Tours          | @gudbro/tours-frontend          | PASS/FAIL    | N            | ...      |
| Accommodations | @gudbro/accommodations-frontend | PASS/FAIL    | N            | ...      |

## Fixes Applied

[List each inline fix with file, line, what was changed]

## Warnings Logged (Non-blocking)

[List warnings seen but not fixed]

## Failed Builds (if any)

[Details of any complex failures needing follow-up]
```

Commit any inline fixes with descriptive messages like: `fix(03-01): resolve [vertical] build error in [file]`
</action>
<verify>
Tours and Accommodations produce exit code 0 from `pnpm --filter <name> build`. The file `.planning/phases/03-verification/build-results.md` exists and shows status for all 7 verticals.
</verify>
<done>All 7 verticals build successfully. Build results documented in build-results.md with per-vertical status, fixes applied, and warnings logged.</done>
</task>

</tasks>

<verification>
- All 7 `pnpm --filter @gudbro/*-frontend build` commands exit with code 0
- build-results.md exists with complete status for all 7 verticals
- Any inline fixes are committed atomically
</verification>

<success_criteria>

- BLD-01 through BLD-07: All 7 vertical PWAs build successfully
- Zero build errors across all verticals
- Build results documented for next plan to reference
  </success_criteria>

<output>
After completion, create `.planning/phases/03-verification/03-01-SUMMARY.md`
</output>
