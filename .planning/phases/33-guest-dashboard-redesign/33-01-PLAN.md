---
phase: 33-guest-dashboard-redesign
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/accommodations/frontend/components/stay/DashboardGrid.tsx
  - apps/accommodations/frontend/components/stay/DashboardCard.tsx
  - apps/accommodations/frontend/components/stay/WifiCard.tsx
  - apps/accommodations/frontend/app/stay/[code]/page.tsx
autonomous: true

must_haves:
  truths:
    - 'Homepage displays 6-8 colored clickable cards instead of a scrolling text wall'
    - 'WiFi box is dismissible via X button and recoverable'
    - 'Tapping a card navigates to the relevant section or opens the relevant sheet'
    - 'All existing state contracts (cart, orders, documents, services, token) remain functional'
  artifacts:
    - path: 'apps/accommodations/frontend/components/stay/DashboardGrid.tsx'
      provides: '2-column CSS grid wrapper for dashboard cards'
      min_lines: 20
    - path: 'apps/accommodations/frontend/components/stay/DashboardCard.tsx'
      provides: 'Reusable colored card with icon, label, optional badge/count'
      min_lines: 25
    - path: 'apps/accommodations/frontend/components/stay/WifiCard.tsx'
      provides: 'WiFi card with dismiss X button using localStorage'
    - path: 'apps/accommodations/frontend/app/stay/[code]/page.tsx'
      provides: 'Homepage tab renders DashboardGrid with cards instead of stacked sections'
  key_links:
    - from: 'DashboardGrid.tsx'
      to: 'DashboardCard.tsx'
      via: 'renders DashboardCard children'
      pattern: 'DashboardCard'
    - from: 'page.tsx'
      to: 'DashboardGrid.tsx'
      via: 'home tab renders DashboardGrid'
      pattern: 'DashboardGrid'
    - from: 'WifiCard.tsx'
      to: 'localStorage'
      via: 'dismiss state persistence'
      pattern: 'localStorage.*wifi.*dismiss'
---

<objective>
Replace the scrolling text wall homepage with a modern card-based grid layout and add WiFi dismiss/recover functionality.

Purpose: NAV-01 (card-based homepage) and NAV-02 (dismissible WiFi) -- the two highest-impact visual changes for the guest dashboard.
Output: DashboardGrid.tsx, DashboardCard.tsx components + rewired homepage in page.tsx + WiFi dismiss in WifiCard.tsx
</objective>

<execution_context>
@/Users/gianfrancodagostino/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gianfrancodagostino/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/33-guest-dashboard-redesign/33-RESEARCH.md

Key source files:
@apps/accommodations/frontend/app/stay/[code]/page.tsx
@apps/accommodations/frontend/components/stay/WifiCard.tsx
@apps/accommodations/frontend/components/stay/ReturnGuestBanner.tsx (localStorage dismiss pattern to follow)
@apps/accommodations/frontend/components/stay/DashboardHeader.tsx
@apps/accommodations/frontend/components/BottomNav.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DashboardGrid and DashboardCard components</name>
  <files>
    apps/accommodations/frontend/components/stay/DashboardGrid.tsx
    apps/accommodations/frontend/components/stay/DashboardCard.tsx
  </files>
  <action>
Create two new components:

**DashboardGrid.tsx:**

- A wrapper component that renders children in a `grid grid-cols-2 gap-3` layout
- Accepts `children: React.ReactNode` and optional `className`
- The grid should be inside `px-4 py-4` padding
- Simple, no state management -- purely layout

**DashboardCard.tsx:**

- Props: `icon` (Phosphor Icon component), `label` (string), `color` (string for bg tint like '#3D8B87'), `onClick` (() => void), optional `badge` (string), optional `count` (number), optional `description` (string)
- Renders a rounded-2xl card with:
  - Background: white with a subtle tinted top stripe or left accent using the `color` prop (use `style={{ borderTopColor: color }}` with a 3px colored top border)
  - Icon: 32px Phosphor icon with duotone weight, colored with the `color` prop
  - Label: text-sm font-semibold text-[#2D2016]
  - Description (if provided): text-[11px] text-[#8B7355] truncated single line
  - Badge (if provided): small pill in top-right (e.g., count of orders, "New")
  - Count (if provided): shown as a small number badge on the icon
- Card has `active:scale-[0.97]` press feedback and shadow-sm
- Card height should be consistent: min-h-[88px] with flex-col justify-center items-center text-center layout

Use Phosphor Icons (already in the project). Do NOT add any new packages.
</action>
<verify>
TypeScript compilation: `cd apps/accommodations/frontend && npx tsc --noEmit --pretty 2>&1 | head -30`
Both files exist and export default components.
</verify>
<done>DashboardGrid renders a 2-column CSS grid. DashboardCard renders a tappable colored card with icon, label, and optional badge/count.</done>
</task>

<task type="auto">
  <name>Task 2: Rewire homepage to card grid + WiFi dismiss logic</name>
  <files>
    apps/accommodations/frontend/app/stay/[code]/page.tsx
    apps/accommodations/frontend/components/stay/WifiCard.tsx
  </files>
  <action>
**WifiCard.tsx -- Add dismiss/recover:**
- Add a dismiss X button in the top-right corner of the WiFi card (similar pattern to ReturnGuestBanner.tsx)
- Use localStorage key `'gudbro_wifi_dismissed'`
- Start with `dismissed = true` (hidden) to avoid flash, then check localStorage in useEffect
- When dismissed, render nothing (return null)
- Export a named function `isWifiDismissed()` that reads localStorage -- this will be used by the Concierge hub in Phase 36 to show a "WiFi" recovery link
- Add an optional `onDismiss?: () => void` callback prop so the parent can react (e.g., update card badge)

**page.tsx -- Replace home tab content with card grid:**

Replace the long list of stacked sections in the `case 'home'` of `renderTabContent()` with a DashboardGrid containing DashboardCard items.

CRITICAL: Keep ALL existing state management at page level. Do NOT move any useState/useEffect/useCallback. The card grid is ONLY the visual entry point -- tapping a card either:

1. Scrolls to / shows the existing section (for WiFi, Services, Orders, Documents)
2. Opens a sheet/overlay (for House Rules -- Phase 33-02 will handle this)
3. Switches tab (for Profile -- Phase 33-02 will handle this)

**Homepage card layout (inside DashboardGrid):**

Row 1:

- WiFi card: WifiHigh icon, color '#3D8B87', label 'WiFi'. Only shown if wifi data exists AND not dismissed. onClick: scroll to WiFi section below the grid.
- Services card: CallBell icon, color '#E07A5F', label 'Services', badge showing category count. onClick: `setShowCatalog(true)`.

Row 2:

- House Rules card: BookOpen icon, color '#8B6914', label 'House Rules'. onClick: no-op for now (33-02 will wire HouseRulesSheet).
- Documents card: IdentificationCard icon, color '#6366F1', label 'Documents', badge showing document count. onClick: scroll to documents section.

Row 3:

- Orders card: ClipboardText icon, color '#059669', label 'Orders', badge showing active order count. onClick: scroll to orders section.
- Concierge card: Compass icon, color '#D97706', label 'Concierge'. onClick: no-op for now (Phase 36 will build this).

**Below the card grid**, keep these existing sections in a simplified flow (they serve as the "detail" views when cards are tapped):

1. WifiCard (with dismiss support) -- wrapped in a div with an id="wifi-section" for scroll targeting
2. ServicesCarousel (keep as-is, it loads categories)
3. ActiveOrders -- wrapped with id="orders-section"
4. Documents section -- wrapped with id="documents-section"
5. LocalDeals
6. UsefulNumbers

**Remove from homepage** (moved elsewhere in 33-02):

- CheckoutInfo (moves into HouseRulesSheet in 33-02)
- ContactSheet button (moves to header in 33-02)
- QuickActions (absorbed by card grid)
- WelcomeCard (redundant with header showing property name)
- VisaStatusCard + VisaExpiryAlert (move to Profile in 33-02)
- ReturnGuestBanner (keep for now, can be removed later)

For scroll targeting, use `document.getElementById('wifi-section')?.scrollIntoView({ behavior: 'smooth' })`.

Keep the WelcomeCard import but comment it out with `// Moved to profile in 33-02` so 33-02 knows to handle it. Same for CheckoutInfo, ContactSheet, QuickActions, VisaStatusCard, VisaExpiryAlert.

Add a `wifiDismissed` state (boolean) initialized from localStorage, to control whether the WiFi card appears in the grid. When WifiCard calls onDismiss, update this state.

Import DashboardGrid, DashboardCard, and needed Phosphor icons (WifiHigh, CallBell, BookOpen, IdentificationCard, ClipboardText, Compass).
</action>
<verify>

1. TypeScript compilation: `cd apps/accommodations/frontend && npx tsc --noEmit --pretty 2>&1 | head -30`
2. Build check: `cd apps/accommodations/frontend && npx next build 2>&1 | tail -20`
3. Verify page.tsx still imports and uses: useServiceCart, useOrderPolling, useStaySession, CartFAB, CartDrawer, ServiceCatalog, BottomNav (all critical state contracts preserved)
   </verify>
   <done>
   Homepage shows a 2-column card grid (WiFi, Services, House Rules, Documents, Orders, Concierge) above detailed sections. WiFi card has dismiss X button with localStorage persistence. All cart/order/service/document state contracts are preserved. Cards for House Rules, Profile, and Concierge are placeholders (wired in later plans/phases).
   </done>
   </task>

</tasks>

<verification>
1. `cd apps/accommodations/frontend && npx tsc --noEmit` -- zero errors
2. `cd apps/accommodations/frontend && npx next build` -- build succeeds
3. Grep for state contracts preserved: `grep -c "useServiceCart\|useOrderPolling\|useStaySession\|CartFAB\|CartDrawer\|ServiceCatalog" apps/accommodations/frontend/app/stay/\[code\]/page.tsx` -- should return 6+
4. New files exist: DashboardGrid.tsx, DashboardCard.tsx
5. WifiCard.tsx contains localStorage dismiss logic: `grep "wifi.*dismiss" apps/accommodations/frontend/components/stay/WifiCard.tsx`
</verification>

<success_criteria>

- Homepage renders a 2-column card grid with 6 cards (WiFi, Services, House Rules, Documents, Orders, Concierge)
- WiFi card has a dismiss X button that persists via localStorage
- Dismissed WiFi card disappears from both the grid and the detail section
- All existing functionality (cart, orders, services, documents, catalog overlay) works unchanged
- TypeScript compiles without errors
- Next.js build succeeds
  </success_criteria>

<output>
After completion, create `.planning/phases/33-guest-dashboard-redesign/33-01-SUMMARY.md`
</output>
