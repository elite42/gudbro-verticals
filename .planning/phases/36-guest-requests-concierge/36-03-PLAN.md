---
phase: 36-guest-requests-concierge
plan: 03
type: execute
wave: 2
depends_on: ['36-01']
files_modified:
  - apps/accommodations/frontend/components/stay/ConciergeDiscover.tsx
  - apps/accommodations/frontend/lib/concierge-data.ts
  - apps/accommodations/frontend/components/stay/ConciergeHub.tsx
  - apps/accommodations/frontend/app/stay/[code]/page.tsx
autonomous: true

must_haves:
  truths:
    - 'Explore tab in BottomNav shows local attractions page (not placeholder)'
    - 'Discover section in Concierge hub shows same attractions content'
    - 'Attractions display as cards with name, description, category, and distance'
    - 'Cross-vertical deep-links to Tours PWA are present where applicable'
  artifacts:
    - path: 'apps/accommodations/frontend/components/stay/ConciergeDiscover.tsx'
      provides: 'Card-based attractions and experiences page'
      min_lines: 80
  key_links:
    - from: 'ConciergeHub.tsx'
      to: 'ConciergeDiscover.tsx'
      via: 'activeSection === discover'
      pattern: 'activeSection.*discover.*ConciergeDiscover'
    - from: 'page.tsx (map tab)'
      to: 'ConciergeDiscover.tsx'
      via: 'renderTabContent case map'
      pattern: 'case.*map.*ConciergeDiscover'
    - from: 'ConciergeDiscover.tsx'
      to: 'concierge-data.ts'
      via: 'getLocalAttractions import'
      pattern: 'getLocalAttractions'
---

<objective>
Build the Explore/Map page and Discover section showing local attractions, tours, and experiences as card-based content. The same component serves both the BottomNav "Explore" tab and the Concierge hub "Discover" section.

Purpose: Guests can discover nearby points of interest, activities, and tours directly from the PWA, with deep-links to the Tours vertical where applicable.
Output: ConciergeDiscover component replacing the Explore placeholder, populated with curated Vietnam attractions data.
</objective>

<execution_context>
@/Users/gianfrancodagostino/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gianfrancodagostino/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/36-guest-requests-concierge/36-RESEARCH.md
@.planning/phases/36-guest-requests-concierge/36-01-SUMMARY.md
@apps/accommodations/frontend/components/stay/ConciergeHub.tsx
@apps/accommodations/frontend/app/stay/[code]/page.tsx
@apps/accommodations/frontend/lib/concierge-data.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Attractions data + ConciergeDiscover component</name>
  <files>
    apps/accommodations/frontend/lib/concierge-data.ts
    apps/accommodations/frontend/components/stay/ConciergeDiscover.tsx
  </files>
  <action>
    1. Add attractions data to concierge-data.ts:
       - LocalAttraction interface: { id, name, description, category: 'landmark' | 'market' | 'temple' | 'museum' | 'beach' | 'nature' | 'nightlife' | 'food', distance?: string, deepLink?: string, imageEmoji?: string }
       - TourExperience interface: { id, name, description, duration, priceRange, deepLink?: string }
       - Add to CONCIERGE_DATA['VN']:
         - attractions: array of 12-15 popular Vietnam attractions organized by category
           - Include: Ben Thanh Market, War Remnants Museum, Cu Chi Tunnels, Mekong Delta tours, Bui Vien Walking Street, Jade Emperor Pagoda, Notre-Dame Cathedral, Bitexco Tower, Pham Ngu Lao area, Saigon River, District 1 food streets, Thien Hau Temple
           - Each with category, brief description, distance estimate from center
         - tours: array of 6-8 experience types
           - Include: Street food tour, Motorbike city tour, Mekong Delta day trip, Cu Chi Tunnels, Cooking class, Coffee workshop, Night market tour, Temple tour
           - Each with duration, price range, optional deep-link to Tours PWA
       - Export getLocalAttractions(country: string) and getTourExperiences(country: string) helpers

    2. Create ConciergeDiscover.tsx:
       - Props: { country: string; onBack?: () => void } (onBack is optional -- absent when used as Explore tab)
       - Import getLocalAttractions and getTourExperiences from concierge-data.ts
       - Layout:
         - If onBack provided: show header with back button + "Discover" title (Concierge sub-view mode)
         - If no onBack: show just a title "Explore {city}" with a brief subtitle (BottomNav tab mode)
       - Category filter pills: horizontal scroll of category buttons (All, Landmarks, Markets, Temples, Museums, Nature, Food, Nightlife)
         - Tapping a category filters attractions list
         - "All" shows everything
       - Attractions grid: 2-column card grid on mobile
         - Each card: emoji icon (based on category -- temple, market, museum, etc.), name, category badge, distance, brief description (2 lines max, truncated)
         - Cards are tappable -- if deepLink exists, opens in new tab; otherwise shows expanded description in-place
       - Tours section below attractions: "Experiences & Tours" header
         - Horizontal scroll of tour cards (wider format)
         - Each card: name, duration badge, price range, description
         - If deepLink exists, show "Book on Tours" button linking to Tours PWA
       - Empty state if no data for country: "Attraction info coming soon for this location"
       - Use MapPin, Buildings, Church, CookingPot, Moon, Tree, ShoppingBag from Phosphor icons for categories

  </action>
  <verify>
    - Attractions data exists: grep "LocalAttraction\|getLocalAttractions" apps/accommodations/frontend/lib/concierge-data.ts
    - Component created: test -f apps/accommodations/frontend/components/stay/ConciergeDiscover.tsx
    - Has category filter: grep "category\|filter" apps/accommodations/frontend/components/stay/ConciergeDiscover.tsx
    - Has tour section: grep "tour\|experience" apps/accommodations/frontend/components/stay/ConciergeDiscover.tsx
  </verify>
  <done>
    concierge-data.ts has 12-15 Vietnam attractions and 6-8 tour experiences. ConciergeDiscover shows filterable attraction cards and a tours section with deep-links.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire ConciergeDiscover into hub + Explore tab</name>
  <files>
    apps/accommodations/frontend/components/stay/ConciergeHub.tsx
    apps/accommodations/frontend/app/stay/[code]/page.tsx
  </files>
  <action>
    1. Update ConciergeHub.tsx:
       - Import ConciergeDiscover
       - Replace the Discover placeholder with ConciergeDiscover component when activeSection === 'discover'
       - Pass country from concierge config and onBack={() => setActiveSection(null)}

    2. Update page.tsx (stay/[code]/page.tsx):
       - Import ConciergeDiscover
       - Replace the map/Explore tab placeholder (case 'map') with:
         <ConciergeDiscover country={propertyExtended?.country || 'VN'} />
         (no onBack prop -- tab mode, no back button needed)
       - Remove the old placeholder div with "Explore the local area... Coming soon."

    3. Verify no regressions:
       - BottomNav "Explore" tab renders ConciergeDiscover (tab mode, no back button)
       - Concierge hub "Discover" card renders ConciergeDiscover (sub-view mode, with back button)
       - Both use same component, same data, different header treatment

  </action>
  <verify>
    - Hub imports ConciergeDiscover: grep "ConciergeDiscover" apps/accommodations/frontend/components/stay/ConciergeHub.tsx
    - Page imports ConciergeDiscover: grep "ConciergeDiscover" apps/accommodations/frontend/app/stay/[code]/page.tsx
    - Map case uses ConciergeDiscover: grep -A 3 "case.*map" apps/accommodations/frontend/app/stay/[code]/page.tsx
    - Build check: cd apps/accommodations/frontend && npx next build --no-lint 2>&1 | tail -5
  </verify>
  <done>
    Explore tab shows ConciergeDiscover with attractions and tours (no back button). Concierge hub Discover section shows same component with back button. Both filter by category and show deep-links to Tours PWA.
  </done>
</task>

</tasks>

<verification>
- BottomNav "Explore" tab shows attraction cards (not placeholder)
- Concierge hub "Discover" section shows same attractions
- Category filter pills work (tap to filter, "All" shows everything)
- Tour experience cards show duration and price
- Deep-links open in new tab where present
- Back button works in Concierge sub-view mode
- No back button in Explore tab mode
</verification>

<success_criteria>

1. Explore tab replaces placeholder with card-based attractions page
2. Concierge Discover section renders same component with back navigation
3. Category filter pills filter attractions list
4. Tour experiences section shows bookable activities with deep-links
5. Same ConciergeDiscover component serves both contexts
   </success_criteria>

<output>
After completion, create `.planning/phases/36-guest-requests-concierge/36-03-SUMMARY.md`
</output>
