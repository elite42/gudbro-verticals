---
phase: 36-guest-requests-concierge
plan: 02
type: execute
wave: 2
depends_on: ['36-01']
files_modified:
  - apps/accommodations/frontend/components/stay/ConciergeHub.tsx
  - apps/accommodations/frontend/components/stay/ConciergeEmergency.tsx
  - apps/accommodations/frontend/components/stay/ConciergeSafety.tsx
  - apps/accommodations/frontend/components/stay/ConciergeCulture.tsx
  - apps/accommodations/frontend/components/stay/ConciergeTransport.tsx
  - apps/accommodations/frontend/components/stay/UsefulNumbersPage.tsx
autonomous: true

must_haves:
  truths:
    - 'Emergency numbers and embassy contacts display with click-to-call (tel: links)'
    - 'Safety tips are organized by 7 categories with accordion expand'
    - 'Cultural tips show dos and donts, recommended apps section is present'
    - 'Transport section shows ride-hailing apps, taxi info, and fare guidance'
    - 'Useful numbers live on a dedicated sub-view within the Concierge hub'
  artifacts:
    - path: 'apps/accommodations/frontend/components/stay/ConciergeEmergency.tsx'
      provides: 'Emergency contacts with click-to-call and embassy list'
      min_lines: 60
    - path: 'apps/accommodations/frontend/components/stay/ConciergeSafety.tsx'
      provides: '7-category safety tips with accordion pattern'
      min_lines: 80
    - path: 'apps/accommodations/frontend/components/stay/ConciergeCulture.tsx'
      provides: 'Cultural dos/donts and recommended apps'
      min_lines: 50
    - path: 'apps/accommodations/frontend/components/stay/ConciergeTransport.tsx'
      provides: 'Transport tips and ride-hailing info'
      min_lines: 40
    - path: 'apps/accommodations/frontend/components/stay/UsefulNumbersPage.tsx'
      provides: 'Dedicated useful numbers page with categories'
      min_lines: 40
  key_links:
    - from: 'ConciergeHub.tsx'
      to: 'ConciergeEmergency/Safety/Culture/Transport'
      via: 'activeSection state switching'
      pattern: 'activeSection.*emergency|safety|culture|transport'
    - from: 'ConciergeEmergency.tsx'
      to: 'concierge-data.ts'
      via: 'getConciergeData import'
      pattern: 'getConciergeData'
    - from: 'ConciergeEmergency.tsx'
      to: 'tel: links'
      via: 'anchor href'
      pattern: 'href.*tel:'
---

<objective>
Build the 4 content sections for the Concierge hub (Emergency, Safety, Culture, Transport) plus a dedicated Useful Numbers sub-view. Each section renders as a sub-page within the ConciergeHub overlay, navigated via the section cards built in plan 36-01.

Purpose: Guests get actionable local information (emergency contacts, scam alerts, cultural guidance, transport tips) directly in the PWA, making them feel safe and informed.
Output: All 5 sub-views functional within the ConciergeHub overlay, populated with Vietnam-specific content from concierge-data.ts.
</objective>

<execution_context>
@/Users/gianfrancodagostino/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gianfrancodagostino/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/36-guest-requests-concierge/36-RESEARCH.md
@.planning/phases/36-guest-requests-concierge/36-01-SUMMARY.md
@apps/accommodations/frontend/lib/concierge-data.ts
@apps/accommodations/frontend/components/stay/ConciergeHub.tsx
@apps/accommodations/frontend/components/stay/UsefulNumbers.tsx
@docs/features/TOURIST-SAFETY-GUIDE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Emergency + Safety + Transport + Culture sub-views</name>
  <files>
    apps/accommodations/frontend/components/stay/ConciergeEmergency.tsx
    apps/accommodations/frontend/components/stay/ConciergeSafety.tsx
    apps/accommodations/frontend/components/stay/ConciergeCulture.tsx
    apps/accommodations/frontend/components/stay/ConciergeTransport.tsx
  </files>
  <action>
    All 4 components receive props: { country: string; onBack: () => void }
    All import getConciergeData from concierge-data.ts and use country to get content.
    All have a back arrow header to return to hub main view.

    1. ConciergeEmergency.tsx:
       - Header: "Emergency Contacts" with back button
       - Section 1: "Emergency Numbers" -- red-tinted cards with click-to-call (tel: links)
         - Show each emergency number (Police 113, Fire 114, Ambulance 115, General 112, Tourist Hotline, Tourist Police)
         - Each row: icon, name, number as tappable tel: link, note if any
         - Use Phone icon from Phosphor, red color scheme
       - Section 2: "Embassies & Consulates" -- blue-tinted cards
         - Embassy name, phone number (tel: link), note (e.g. "Ho Chi Minh City")
         - Show at minimum: US, UK, Australia, France, Germany, South Korea, Japan, China
       - Section 3: "Tourist Hotlines" (1900 1883 multilingual, 1800 1091 free)
       - Style: rounded-2xl cards, consistent with existing PWA design

    2. ConciergeSafety.tsx:
       - Header: "Safety Tips" with back button + disclaimer note ("Vietnam is one of the safest...")
       - Render 7 category cards, each as an accordion:
         - Transport, Money, Food & Drink, Street, Hotels, Tours, Digital
         - Each category card: icon, label, tip count badge
         - Accordion expand shows individual tips within that category
         - Each tip: title (bold), description, "How to protect yourself" bullet list, "Where" location if provided
       - Use useState per category for expand/collapse (not global -- multiple can be open)
       - Categories collapsed by default
       - Use CaretDown/CaretUp from Phosphor for expand indicator

    3. ConciergeCulture.tsx:
       - Header: "Culture & Tips" with back button
       - Section 1: "Do's" -- green checkmark icon, list of cultural do's
       - Section 2: "Don'ts" -- red X icon, list of cultural don'ts
       - Section 3: "Recommended Apps" -- app cards with name, description, platform badges (iOS/Android/Both)
         - Include: Grab (rides + food), Be (rides), Xanh SM (electric rides), Wise (money transfer), Google Translate (translation)
       - Clean card layout, each do/don't as a row with icon + text

    4. ConciergeTransport.tsx:
       - Header: "Getting Around" with back button
       - Transport options as cards: Grab/Be/Xanh SM (ride-hailing), Metered Taxis (Vinasun/Mai Linh), Xe Om (motorbike taxi), City Bus, Cyclo (tourist), Motorbike Rental
       - Each card: transport type icon, name, description, price range if available, safety tip
       - Highlight recommended options (Grab, Vinasun, Mai Linh) vs risky ones (random xe om, cyclo in tourist zones)
       - Use Car, Taxi, Bicycle, Bus from Phosphor icons

  </action>
  <verify>
    - Emergency has tel: links: grep "tel:" apps/accommodations/frontend/components/stay/ConciergeEmergency.tsx
    - Safety has accordion state: grep "useState" apps/accommodations/frontend/components/stay/ConciergeSafety.tsx
    - Culture has dos/donts: grep "do.*dont\|Do.*Don" apps/accommodations/frontend/components/stay/ConciergeCulture.tsx
    - Transport exists: test -f apps/accommodations/frontend/components/stay/ConciergeTransport.tsx
    - All import getConciergeData: grep -l "getConciergeData" apps/accommodations/frontend/components/stay/Concierge*.tsx
  </verify>
  <done>
    4 sub-view components render Vietnam-specific content from concierge-data.ts. Emergency shows click-to-call numbers and embassies. Safety shows 7 accordion categories with tips. Culture shows dos/donts and recommended apps. Transport shows ride options with safety guidance.
  </done>
</task>

<task type="auto">
  <name>Task 2: Useful Numbers page + wire all sections into ConciergeHub</name>
  <files>
    apps/accommodations/frontend/components/stay/UsefulNumbersPage.tsx
    apps/accommodations/frontend/components/stay/ConciergeHub.tsx
  </files>
  <action>
    1. Create UsefulNumbersPage.tsx:
       - Props: { bookingCode: string; token: string; onBack: () => void }
       - Fetch /api/stay/{bookingCode}/useful-numbers (existing API)
       - Render useful numbers grouped by type: emergency_numbers, city_useful_numbers, merchant_useful_numbers
       - Each number row: name, phone number as tel: link, category badge
       - Group headers: "Emergency", "City Services", "Property Contacts"
       - Loading skeleton while fetching
       - Follow existing UsefulNumbers.tsx patterns but as a full sub-view (not compact card)
       - Back button header to return to hub

    2. Update ConciergeHub.tsx to wire all section sub-views:
       - Replace the "Coming soon" placeholders with actual components
       - Import: ConciergeEmergency, ConciergeSafety, ConciergeCulture, ConciergeTransport, UsefulNumbersPage
       - Add 'useful-numbers' to the activeSection type (alongside the 5 main sections)
       - When activeSection is set, render the corresponding component instead of the hub card grid
       - Each sub-component gets onBack={() => setActiveSection(null)} to return to hub
       - Add a "Useful Numbers" quick link card at bottom of section cards (below the 5 main sections) that sets activeSection to 'useful-numbers'
       - The "Discover" section card should navigate to activeSection 'discover' -- render a placeholder saying "Explore local attractions. Coming soon in the next update." (Plan 36-03 builds this)
       - Ensure the quick links row (WiFi, Documents, Contact, Room Service) remains visible on the hub main view but NOT on sub-views

  </action>
  <verify>
    - UsefulNumbersPage fetches API: grep "useful-numbers" apps/accommodations/frontend/components/stay/UsefulNumbersPage.tsx
    - ConciergeHub imports all sections: grep "ConciergeEmergency\|ConciergeSafety\|ConciergeCulture\|ConciergeTransport\|UsefulNumbersPage" apps/accommodations/frontend/components/stay/ConciergeHub.tsx
    - Sections are wired: grep "activeSection" apps/accommodations/frontend/components/stay/ConciergeHub.tsx
    - Build check: cd apps/accommodations/frontend && npx next build --no-lint 2>&1 | tail -5
  </verify>
  <done>
    All 5 section sub-views (Emergency, Safety, Culture, Transport, Useful Numbers) render within ConciergeHub when their card is tapped. Back navigation returns to hub main view. Useful Numbers page fetches from existing API and displays categorized numbers with click-to-call. Discover section shows placeholder for Phase 36-03.
  </done>
</task>

</tasks>

<verification>
- Tapping Emergency card shows emergency numbers with tel: links
- Tapping Safety card shows 7 accordion categories, collapsed by default
- Tapping Culture card shows dos/donts and recommended apps
- Tapping Transport card shows transport options with safety tips
- Tapping Useful Numbers link shows categorized phone numbers
- Back button on each sub-view returns to hub main view
- All content sourced from concierge-data.ts (not hardcoded in JSX)
- Discover card shows placeholder (not broken)
</verification>

<success_criteria>

1. Emergency contacts display with click-to-call for all numbers and embassies
2. Safety tips organized by 7 categories with working accordion expand/collapse
3. Cultural tips show dos/donts and recommended apps are listed
4. Transport section shows ride options with safety guidance
5. Useful numbers page displays data from existing API with click-to-call
6. All sub-views navigate correctly within the ConciergeHub overlay
   </success_criteria>

<output>
After completion, create `.planning/phases/36-guest-requests-concierge/36-02-SUMMARY.md`
</output>
