---
phase: 41-shared-foundation
plan: 03
type: execute
wave: 2
depends_on: ['41-01']
files_modified:
  - shared/ui/components/bottom-nav.tsx
  - shared/ui/index.ts
  - shared/types/domain.ts
  - shared/types/index.ts
autonomous: true

must_haves:
  truths:
    - 'shared/ui/ exports a configurable BottomNav component with NavItem[] props, activeColor, optional onCenterClick, and optional centerBadge'
    - 'shared/types/ exports MenuItem, Order, and MerchantCharge domain types'
    - 'Both @gudbro/ui and @gudbro/types build successfully after additions'
  artifacts:
    - path: 'shared/ui/components/bottom-nav.tsx'
      provides: 'Configurable BottomNav component'
      contains: 'export function BottomNav'
    - path: 'shared/types/domain.ts'
      provides: 'Consolidated domain types'
      contains: 'MenuItem'
  key_links:
    - from: 'shared/ui/components/bottom-nav.tsx'
      to: 'next/link'
      via: 'import Link'
      pattern: "import Link from 'next/link'"
    - from: 'shared/ui/index.ts'
      to: 'shared/ui/components/bottom-nav.tsx'
      via: 'barrel export'
      pattern: 'export.*BottomNav'
---

<objective>
Create the shared BottomNav component in @gudbro/ui and consolidated domain types in @gudbro/types.

Purpose: These are the remaining shared artifacts needed before PWA migration can begin. BottomNav exists in 4+ apps (gym, laundry, pharmacy, workshops) with nearly identical structure differing only in nav items, active color, and center button behavior. Domain types (MenuItem, Order, MerchantCharge) are used across apps but defined locally.

Output: Shared BottomNav in @gudbro/ui, domain types in @gudbro/types
</objective>

<execution_context>
@/Users/gianfrancodagostino/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gianfrancodagostino/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/41-shared-foundation/41-RESEARCH.md
@.planning/phases/41-shared-foundation/41-01-SUMMARY.md

# BottomNav reference implementations:

@apps/gym/frontend/components/BottomNav.tsx
@apps/laundry/frontend/components/BottomNav.tsx
@apps/pharmacy/frontend/components/BottomNav.tsx
@apps/workshops/frontend/components/BottomNav.tsx

# Existing shared types (check for conflicts):

@shared/types/custom.ts
@shared/types/index.ts

# Existing shared UI:

@shared/ui/index.ts
@shared/ui/components/button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared BottomNav component</name>
  <files>
    shared/ui/components/bottom-nav.tsx
    shared/ui/index.ts
  </files>
  <action>
    **shared/ui/components/bottom-nav.tsx:**
    Create a configurable BottomNav component that replaces 4 separate implementations. Follow the code example from 41-RESEARCH.md closely.

    Key design:
    - `'use client'` directive at top
    - Import `Link` from 'next/link', `usePathname` from 'next/navigation'
    - Export `NavItem` interface: `{ label: string; href: string; icon: (active: boolean) => ReactNode; isCenter?: boolean }`
    - Export `BottomNavProps` interface: `{ items: NavItem[]; activeColor: string; borderColor?: string; onCenterClick?: () => void; centerBadge?: number }`
    - Export `BottomNav` component that:
      - Renders a fixed-bottom nav with `pb-safe md:hidden`
      - Maps over items, determines active state by pathname matching
      - Center item: If `onCenterClick` is provided, renders as `<button>` (gym/laundry pattern). Otherwise renders as `<Link>` (pharmacy/workshops pattern)
      - Badge support on center item (laundry uses this for order count)
      - Active state: scale(1.1) transform + activeColor, matching current implementations
      - Inactive: `var(--charcoal-muted)` color
    - Follow the styling conventions of existing @gudbro/ui components (see button.tsx for reference)

    **shared/ui/index.ts:** Add `export { BottomNav, type NavItem, type BottomNavProps } from './components/bottom-nav'` to the existing barrel exports. Do NOT remove any existing exports.

  </action>
  <verify>
    Run `pnpm --filter @gudbro/ui build` -- must succeed.
    Verify BottomNav export: `grep "BottomNav" shared/ui/index.ts` should show the export.
  </verify>
  <done>
    @gudbro/ui exports BottomNav, NavItem, BottomNavProps. Package builds successfully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create consolidated domain types</name>
  <files>
    shared/types/domain.ts
    shared/types/index.ts
  </files>
  <action>
    **shared/types/domain.ts:**
    Create consolidated domain types. Check what already exists in shared/types/custom.ts first -- if MenuItem is already defined there, ensure no conflict.
    - Export `MenuItem` type (with id, name, description, price, category, image, etc.)
    - Export `Order` type (with id, items, total, status, timestamps, etc.)
    - Export `MerchantCharge` type (with id, amount, currency, description, etc.)
    - Base these on the actual types used across apps -- read the existing types in apps/coffeeshop/frontend/types/, apps/gym/frontend/types/, etc. to find the real shapes
    - If shared/types/custom.ts already has MenuItem, re-export it from domain.ts or update custom.ts and export from there

    **shared/types/index.ts:** Add barrel exports for new domain types. Do NOT remove existing exports.

  </action>
  <verify>
    Run `pnpm --filter @gudbro/types build` -- must succeed.
    Verify domain types: `grep -E "MenuItem|Order|MerchantCharge" shared/types/domain.ts` should match all three.
  </verify>
  <done>
    @gudbro/types exports MenuItem, Order, MerchantCharge domain types. Package builds successfully.
  </done>
</task>

</tasks>

<verification>
1. `pnpm --filter @gudbro/ui build` passes
2. `pnpm --filter @gudbro/types build` passes
3. BottomNav is exported from shared/ui/index.ts
4. domain.ts contains MenuItem, Order, and MerchantCharge types
5. No existing exports in shared/ui/index.ts or shared/types/index.ts are broken
</verification>

<success_criteria>

- shared/ui/ exports BottomNav with configurable props (items, activeColor, onCenterClick, centerBadge)
- shared/types/ exports MenuItem, Order, MerchantCharge domain types
- Both packages build successfully
- No regressions in existing package exports
  </success_criteria>

<output>
After completion, create `.planning/phases/41-shared-foundation/41-03-SUMMARY.md`
</output>
