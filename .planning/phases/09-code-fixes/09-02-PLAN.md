---
phase: 09-code-fixes
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/tours/frontend/styles/globals.css
  - apps/tours/frontend/tailwind.config.ts
  - apps/tours/frontend/app/page.tsx
  - apps/tours/frontend/components/layout/BottomNav.tsx
  - apps/tours/frontend/components/tours/TourCardV2.tsx
  - apps/tours/frontend/components/tours/TourCards.tsx
  - apps/tours/frontend/components/ui/Badge.tsx
  - apps/wellness/frontend/app/page.tsx
  - apps/wellness/frontend/app/promotions/page.tsx
  - apps/wellness/frontend/app/search/page.tsx
  - apps/wellness/frontend/app/services/[slug]/page.tsx
  - apps/wellness/frontend/app/services/page.tsx
  - apps/wellness/frontend/app/staff/[slug]/page.tsx
  - apps/wellness/frontend/app/staff/page.tsx
  - apps/wellness/frontend/components/ServiceCard.tsx
  - apps/wellness/frontend/lib/seo/performance.js
autonomous: true

must_haves:
  truths:
    - 'Tours brand colors (ratings, active states, badges, CTAs) use CSS variables, not hardcoded amber/emerald/orange/red Tailwind values'
    - 'pnpm lint produces zero warnings for the Wellness app'
  artifacts:
    - path: 'apps/tours/frontend/styles/globals.css'
      provides: 'Complete CSS variable system for brand theming'
      contains: '--accent'
    - path: 'apps/tours/frontend/tailwind.config.ts'
      provides: 'Tailwind token mapping for brand CSS variables'
      contains: 'accent'
    - path: 'apps/wellness/frontend/app/search/page.tsx'
      provides: 'Clean lint-free search page'
      pattern: 'no-explicit-any resolved'
  key_links:
    - from: 'apps/tours/frontend/styles/globals.css'
      to: 'apps/tours/frontend/tailwind.config.ts'
      via: 'CSS variables consumed by Tailwind config'
      pattern: "hsl\\(var\\(--accent"
    - from: 'apps/tours/frontend/components/tours/TourCardV2.tsx'
      to: 'apps/tours/frontend/tailwind.config.ts'
      via: 'Tailwind utility classes using theme tokens'
      pattern: 'text-accent|bg-accent'
---

<objective>
Migrate Tours brand colors from hardcoded Tailwind values to CSS variables (CFIX-02) and resolve all 20 ESLint warnings in Wellness (CFIX-04).

Purpose: Ensure Tours theming is maintainable via CSS variables and Wellness codebase is lint-clean.
Output: Zero hardcoded brand colors in Tours, zero lint warnings in Wellness.
</objective>

<execution_context>
@/Users/gianfrancodagostino/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gianfrancodagostino/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-code-fixes/09-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Tours brand colors to CSS variables (CFIX-02)</name>
  <files>
    apps/tours/frontend/styles/globals.css
    apps/tours/frontend/tailwind.config.ts
    apps/tours/frontend/app/page.tsx
    apps/tours/frontend/components/layout/BottomNav.tsx
    apps/tours/frontend/components/tours/TourCardV2.tsx
    apps/tours/frontend/components/tours/TourCards.tsx
    apps/tours/frontend/components/ui/Badge.tsx
  </files>
  <action>
    **Scope: Brand theming colors ONLY.** Do NOT touch:
    - Neutral grays (gray-50 through gray-950) -- these are theme-agnostic
    - Payment provider colors (Stripe blue, MoMo pink) -- brand-specific to providers
    - Category gradient decorative colors (blue-to-cyan, purple-to-pink)

    **Step 1: Extend CSS variables in globals.css**

    The file already has `--primary`, `--secondary`, `--accent`, `--success`, `--error` defined. Add any missing semantic tokens needed:
    - `--accent-light` (for bg-amber-100 patterns, light accent backgrounds)
    - `--accent-foreground` (for text on accent backgrounds, if not already defined)
    - `--success-light` (for bg-emerald-100 patterns)
    - `--success-foreground` (for text-emerald-700 patterns)
    - `--error-light` (for bg-red-100 patterns)
    - `--error-foreground` (for text-red-700 patterns)

    Check what already exists before adding duplicates.

    **Step 2: Update tailwind.config.ts**

    Map new CSS variables to Tailwind utility classes. The config likely already has `accent`, `success`, `error`. Add light/foreground variants if missing:
    ```
    accent: { DEFAULT: 'hsl(var(--accent))', light: 'hsl(var(--accent-light))', foreground: 'hsl(var(--accent-foreground))' }
    ```

    **Step 3: Replace hardcoded brand colors in components**

    Apply these mappings across all affected files:
    - `text-amber-400`, `text-amber-500` -> `text-accent` (ratings, stars, active states)
    - `bg-amber-100`, `bg-amber-50` -> `bg-accent-light` or `bg-accent/10` (light backgrounds)
    - `text-amber-800` -> `text-accent-foreground` (text on light accent bg)
    - `from-amber-500 to-orange-500` -> `from-accent to-primary` or define a gradient variable (featured badges)
    - `bg-emerald-500`, `text-emerald-700` -> `bg-success`, `text-success` (verified, available)
    - `bg-emerald-100` -> `bg-success-light` or `bg-success/10`
    - `bg-red-500`, `text-red-500` -> `bg-error`, `text-error` (deals, favorites, errors)
    - `bg-red-100` -> `bg-error-light` or `bg-error/10`

    **Key files to update (in priority order):**
    1. `components/ui/Badge.tsx` -- badge variants use amber, emerald, orange, red
    2. `components/tours/TourCardV2.tsx` -- ratings (amber), availability (emerald)
    3. `components/tours/TourCards.tsx` -- ratings (amber), favorites (red)
    4. `components/layout/BottomNav.tsx` -- active tab (amber)
    5. `app/page.tsx` -- homepage active states, ratings, deals

    **Important constraints:**
    - Preserve dark mode variants. If a color has `dark:text-amber-300`, map to an appropriate dark mode CSS variable or use opacity modifiers.
    - Preserve hover/focus states. `hover:bg-amber-100` -> `hover:bg-accent-light`.
    - The `globals.css` already has `.badge-accent`, `.badge-verified`, `.star-filled`, `.star-empty` utility classes -- use these where applicable instead of inline Tailwind.
    - Do NOT change any color that is NOT brand-theming (grays, payment colors, category gradients).
    - If a gradient like `from-amber-500 to-orange-500` maps cleanly to existing tokens, use them. If not, define a CSS class in globals.css rather than adding excessive CSS variables.

  </action>
  <verify>
    `grep -rn "text-amber\|bg-amber\|text-emerald\|bg-emerald\|from-amber\|to-amber\|from-orange\|to-orange" apps/tours/frontend/app/ apps/tours/frontend/components/ --include="*.tsx" --include="*.ts"` should return zero results for brand-theming contexts (some may remain in payment components -- those are acceptable).
    Specifically verify zero amber/emerald in: Badge.tsx, TourCardV2.tsx, TourCards.tsx, BottomNav.tsx.
    `cd apps/tours/frontend && npx next build` completes without errors.
    `cd apps/tours/frontend && npx tsc --noEmit` exits with code 0.
  </verify>
  <done>
    Zero hardcoded amber/emerald/orange/red brand-theming colors in Tours components.
    All brand colors use CSS variable-backed Tailwind tokens.
    Tours builds and type-checks successfully.
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix all Wellness ESLint warnings (CFIX-04)</name>
  <files>
    apps/wellness/frontend/app/page.tsx
    apps/wellness/frontend/app/promotions/page.tsx
    apps/wellness/frontend/app/search/page.tsx
    apps/wellness/frontend/app/services/[slug]/page.tsx
    apps/wellness/frontend/app/services/page.tsx
    apps/wellness/frontend/app/staff/[slug]/page.tsx
    apps/wellness/frontend/app/staff/page.tsx
    apps/wellness/frontend/components/ServiceCard.tsx
    apps/wellness/frontend/lib/seo/performance.js
  </files>
  <action>
    Fix all 20 ESLint warnings. Fix root causes, do NOT suppress with eslint-disable comments.

    **1. no-img-element (13 warnings, 7 files)**
    Replace `<img>` with Next.js `<Image>` from `next/image`. For each:
    - Add `import Image from 'next/image'` at top of file
    - Replace `<img src={...} alt={...} className={...} />` with `<Image src={...} alt={...} className={...} width={W} height={H} unoptimized />`
    - Use `unoptimized` prop because all images are external Unsplash URLs (mock data) -- no need to configure remotePatterns for mock data
    - Choose appropriate width/height based on the container context (e.g., 400x300 for cards, 800x400 for hero, 64x64 for avatars)
    - For images using `object-cover` with fill layout, consider using `fill` prop instead of explicit dimensions, with a relative-positioned parent container
    - Preserve all existing className styling

    Files: page.tsx (2), promotions/page.tsx (2), search/page.tsx (1), services/[slug]/page.tsx (3), services/page.tsx (1), staff/[slug]/page.tsx (1), staff/page.tsx (1), ServiceCard.tsx (2)

    **2. no-explicit-any (2 warnings in search/page.tsx)**
    - Define proper TypeScript interfaces for the `any` typed variables
    - Look at the data structure being assigned to determine the correct type
    - Create inline types or interfaces as appropriate

    **3. no-unescaped-entities (2 warnings in search/page.tsx)**
    - Replace literal `"` with `&quot;` or use curly braces with template literals
    - Or wrap the text in `{`backtick strings`}` to avoid JSX entity issues

    **4. react-hooks/exhaustive-deps (1 warning in search/page.tsx)**
    - Add the missing dependency (`apiUrl` or similar) to the useEffect dependency array
    - If adding the dep would cause infinite re-renders, wrap the value in useMemo or useCallback first
    - Do NOT suppress with eslint-disable

    **5. no-unused-vars (2 warnings)**
    - `app/staff/[slug]/page.tsx`: Remove unused `_tab` variable (and its useState if the setter is also unused)
    - `lib/seo/performance.js`: Remove unused `ext` variable or prefix with underscore if it's a destructured value that must be skipped

  </action>
  <verify>
    `cd apps/wellness/frontend && pnpm lint` produces zero warnings and zero errors.
    `cd apps/wellness/frontend && npx next build` completes without errors.
    `cd apps/wellness/frontend && npx tsc --noEmit` exits with code 0.
  </verify>
  <done>
    pnpm lint produces zero warnings for the Wellness app.
    All 20 warnings resolved: 13 img->Image, 2 any->typed, 2 unescaped entities, 1 exhaustive-deps, 2 unused-vars.
    Wellness builds and type-checks successfully.
  </done>
</task>

</tasks>

<verification>
1. `cd apps/tours/frontend && npx next build` -- success
2. `cd apps/tours/frontend && npx tsc --noEmit` -- exit code 0
3. `grep -rn "text-amber\|bg-amber" apps/tours/frontend/components/ui/Badge.tsx apps/tours/frontend/components/tours/TourCardV2.tsx apps/tours/frontend/components/tours/TourCards.tsx apps/tours/frontend/components/layout/BottomNav.tsx` -- zero results
4. `cd apps/wellness/frontend && pnpm lint` -- zero warnings
5. `cd apps/wellness/frontend && npx next build` -- success
</verification>

<success_criteria>

- CFIX-02: Tours brand colors (amber, emerald, orange, red) migrated to CSS variable-backed Tailwind tokens in all component files. Neutral grays, payment colors, and category gradients untouched.
- CFIX-04: pnpm lint on Wellness returns 0 warnings (was 20).
  </success_criteria>

<output>
After completion, create `.planning/phases/09-code-fixes/09-02-SUMMARY.md`
</output>
